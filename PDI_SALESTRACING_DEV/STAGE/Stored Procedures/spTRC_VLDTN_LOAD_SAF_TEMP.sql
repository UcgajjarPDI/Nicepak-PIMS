CREATE PROCEDURE [STAGE].[spTRC_VLDTN_LOAD_SAF_TEMP]  @vSALESPERIOD VARCHAR(10)
WITH EXEC AS CALLER
AS
BEGIN
 
DELETE FROM [PDI_SALESTRACING_TEST].STAGE.SAF_TEMP_V2
WHERE SALESPERIOD = @vSALESPERIOD;

INSERT INTO [PDI_SALESTRACING_TEST].STAGE.SAF_TEMP_V2
(SOURCENUM, SALESPERIOD, DISTCOID, DISTID, DISTNAME, SOURCEFILETYPE, COITEMID, COITEMUOM, COQTYSOLD, COITEMCOST, COTOTALSALESAMNT, COCONTID, REBATEAPPROVEDAMNT, COTOTALREBATE, COLISTPRICE, COACCTID, COACCTTYPE, COACCTSHIPNAME, COACCTSHIPADDR1, COACCTSHIPADDR2, COACCTSHIPADDR3, COACCTSHIPCITY, COACCTSHIPSTATE, COACCTSHIPZIP, COACCTSHIPCOUNTRY, COACCTGLN, COACCTCLASSOFTRADE, COACCTMAX, COACCTPARENTID, COACCTPARENTNAME, DISTACCTID, DISTACCTSHIPNAME, DISTACCTSHIPADDR1, DISTACCTSHIPADDR2, DISTACCTSHIPCITY, DISTACCTSHIPSTATE, DISTACCTSHIPZIP, DISTDIVID, DISTINVOICEID, DISTINVOICEDATE, DISTDEBITMEMOID, DISTCONTID, DISTITEMID, DISTITEMUOM, DISTQTYSOLD, UOMFACTOR, DISTITEMCOST, DISTITEMCONTCOST, DISTEXTENDEDCOST, DISTEXTENDEDCONTCOST, DISTTOTALREBATE, SALESTERRID, SALESREGID, SALESREPID, GROUPID, GROUPACCTID, GROUPFEEAMNT, GROUPFEEPAIDDATE, EDIDISTID, EDIHEADERSEQNUM, EDIDETAILSEQNUM, EDISUBDETAILSEQNUM, EDIRPTDATE, SOURCEFILENUM, SOURCEFILENAME, DISTACCTBILLNAME, DISTACCTBILLADDR1, DISTACCTBILLCITY, DISTACCTBILLSTATE, DISTACCTBILLZIP, DISTINVOICELINENUM, CUSTOMIMPORTFIELD1, GPO_ID, GPO_ALT_ID, ICQUALGLN, GLNNUM, DHQUALDEA, DEANUM, ISACTLNUM, DISTACCTNUM, [CURRENT TIMESTAMP] )
SELECT 
SOURCENUM, SALESPERIOD, DISTCOID, DISTID, DISTNAME, SOURCEFILETYPE, COITEMID, COITEMUOM, COQTYSOLD, COITEMCOST, COTOTALSALESAMNT, COCONTID, REBATEAPPROVEDAMNT, COTOTALREBATE, COLISTPRICE, COACCTID, COACCTTYPE, COACCTSHIPNAME, COACCTSHIPADDR1, COACCTSHIPADDR2, COACCTSHIPADDR3, COACCTSHIPCITY, COACCTSHIPSTATE, COACCTSHIPZIP, COACCTSHIPCOUNTRY, COACCTGLN, COACCTCLASSOFTRADE, COACCTMAX, COACCTPARENTID, COACCTPARENTNAME, DISTACCTID, DISTACCTSHIPNAME, DISTACCTSHIPADDR1, DISTACCTSHIPADDR2, DISTACCTSHIPCITY, DISTACCTSHIPSTATE, DISTACCTSHIPZIP, DISTDIVID, DISTINVOICEID, DISTINVOICEDATE, DISTDEBITMEMOID, DISTCONTID, DISTITEMID, DISTITEMUOM, DISTQTYSOLD, UOMFACTOR, DISTITEMCOST, DISTITEMCONTCOST, DISTEXTENDEDCOST, DISTEXTENDEDCONTCOST, DISTTOTALREBATE, SALESTERRID, SALESREGID, SALESREPID, GROUPID, GROUPACCTID, GROUPFEEAMNT, GROUPFEEPAIDDATE, EDIDISTID, EDIHEADERSEQNUM, EDIDETAILSEQNUM, EDISUBDETAILSEQNUM, EDIRPTDATE, SOURCEFILENUM, SOURCEFILENAME, DISTACCTBILLNAME, DISTACCTBILLADDR1, DISTACCTBILLCITY, DISTACCTBILLSTATE, DISTACCTBILLZIP, DISTINVOICELINENUM, CUSTOMIMPORTFIELD1, GPO_ID, GPO_ALT_ID, ICQUALGLN, GLNNUM, DHQUALDEA, DEANUM, ISACTLNUM, DISTACCTNUM, [CURRENT TIMESTAMP] 
FROM [PDI_SALESTRACING].STAGE.DDS_PDI_SAF_EXTRACT
WHERE SALESPERIOD =  @vSALESPERIOD 
AND SOURCEFILETYPE = 'EDI';

INSERT INTO [PDI_SALESTRACING_TEST].STAGE.SAF_TEMP_V2
(SOURCENUM, SALESPERIOD, DISTCOID, DISTID, DISTNAME, SOURCEFILETYPE, COITEMID, COITEMUOM, COQTYSOLD, COITEMCOST, COTOTALSALESAMNT, COCONTID, REBATEAPPROVEDAMNT, COTOTALREBATE, COLISTPRICE, COACCTID, COACCTTYPE, COACCTSHIPNAME, COACCTSHIPADDR1, COACCTSHIPADDR2, COACCTSHIPADDR3, COACCTSHIPCITY, COACCTSHIPSTATE, COACCTSHIPZIP, COACCTSHIPCOUNTRY, COACCTGLN, COACCTCLASSOFTRADE, COACCTMAX, COACCTPARENTID, COACCTPARENTNAME, DISTACCTID, DISTACCTSHIPNAME, DISTACCTSHIPADDR1, DISTACCTSHIPADDR2, DISTACCTSHIPCITY, DISTACCTSHIPSTATE, DISTACCTSHIPZIP, DISTDIVID, DISTINVOICEID, DISTINVOICEDATE, DISTDEBITMEMOID, DISTCONTID, DISTITEMID, DISTITEMUOM, DISTQTYSOLD, UOMFACTOR, DISTITEMCOST, DISTITEMCONTCOST, DISTEXTENDEDCOST, DISTEXTENDEDCONTCOST, DISTTOTALREBATE, SALESTERRID, SALESREGID, SALESREPID, GROUPID, GROUPACCTID, GROUPFEEAMNT, GROUPFEEPAIDDATE, EDIDISTID, EDIHEADERSEQNUM, EDIDETAILSEQNUM, EDISUBDETAILSEQNUM, EDIRPTDATE, SOURCEFILENUM, SOURCEFILENAME, DISTACCTBILLNAME, DISTACCTBILLADDR1, DISTACCTBILLCITY, DISTACCTBILLSTATE, DISTACCTBILLZIP, DISTINVOICELINENUM, CUSTOMIMPORTFIELD1, GPO_ID, GPO_ALT_ID, ICQUALGLN, GLNNUM, DHQUALDEA, DEANUM, ISACTLNUM, DISTACCTNUM, [CURRENT TIMESTAMP] )
SELECT 
SOURCENUM, SALESPERIOD, DISTCOID, DISTID, DISTNAME, SOURCEFILETYPE, COITEMID, COITEMUOM, COQTYSOLD, COITEMCOST, COTOTALSALESAMNT, COCONTID, REBATEAPPROVEDAMNT, COTOTALREBATE, COLISTPRICE, COACCTID, COACCTTYPE, COACCTSHIPNAME, COACCTSHIPADDR1, COACCTSHIPADDR2, COACCTSHIPADDR3, COACCTSHIPCITY, COACCTSHIPSTATE, COACCTSHIPZIP, COACCTSHIPCOUNTRY, COACCTGLN, COACCTCLASSOFTRADE, COACCTMAX, COACCTPARENTID, COACCTPARENTNAME, DISTACCTID, DISTACCTSHIPNAME, DISTACCTSHIPADDR1, DISTACCTSHIPADDR2, DISTACCTSHIPCITY, DISTACCTSHIPSTATE, DISTACCTSHIPZIP, DISTDIVID, DISTINVOICEID, DISTINVOICEDATE, DISTDEBITMEMOID, DISTCONTID, DISTITEMID, DISTITEMUOM, DISTQTYSOLD, UOMFACTOR, DISTITEMCOST, DISTITEMCONTCOST, DISTEXTENDEDCOST, DISTEXTENDEDCONTCOST, DISTTOTALREBATE, SALESTERRID, SALESREGID, SALESREPID, GROUPID, GROUPACCTID, GROUPFEEAMNT, GROUPFEEPAIDDATE, EDIDISTID, EDIHEADERSEQNUM, EDIDETAILSEQNUM, EDISUBDETAILSEQNUM, EDIRPTDATE, SOURCEFILENUM, SOURCEFILENAME, DISTACCTBILLNAME, DISTACCTBILLADDR1, DISTACCTBILLCITY, DISTACCTBILLSTATE, DISTACCTBILLZIP, DISTINVOICELINENUM, CUSTOMIMPORTFIELD1, GPO_ID, GPO_ALT_ID, ICQUALGLN, GLNNUM, DHQUALDEA, DEANUM, ISACTLNUM, DISTACCTNUM, [CURRENT TIMESTAMP] 
FROM [PDI_SALESTRACING].STAGE.DDS_PDI_SAF_EXTRACT
WHERE SALESPERIOD =  @vSALESPERIOD 
AND SOURCEFILETYPE = 'BLK'
AND DISTCOID IN ('131060','181280','33099','41073','900200','11057','180298','12581','60652','20420','60735','256835');

 END
